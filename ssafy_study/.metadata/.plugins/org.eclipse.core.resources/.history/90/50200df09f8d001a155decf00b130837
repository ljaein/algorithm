import java.util.Scanner;

public class Algo2_대전_6반_이재인 {

	static int T, R, C, N;
	static char[][] map;

	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		T = sc.nextInt();
		for (int t = 1; t <= T; t++) {
			R = sc.nextInt();
			C = sc.nextInt();
			map = new char[R][C];
			for (int i = 0; i < R; i++) {
				map[i] = sc.next().toCharArray();
			}
			N = sc.nextInt();
			for (int i = 0; i < N; i++) {
				int col = sc.nextInt() - 1;
				roll(0, col);
				for (int i = 0; i < R; i++) {
					for (int j = 0; j < C; j++) {
						System.out.print(map[i][j] + " ");
					}
					System.out.println();
				}
			}
		}

	}

	static void roll(int y, int x) {
		int ny = y + 1;
		int nx = x;
		if (ny == R || map[ny][nx] == 'X') {
			map[y][x] = 'O';
			return;
		} else if (map[ny][nx] == '.') {
			roll(ny, nx);
		} else if (map[ny][nx] == 'O') {
			if (nx - 1 >= 0 && map[ny][nx - 1] == '.') {
				roll(ny, nx - 1);
			} else {
				if (nx + 1 < C && map[ny][nx + 1] == '.') {
					roll(ny, nx + 1);
				} else {
					map[y][x] = 'O';
					return;
				}
			}
		}

	}

}
