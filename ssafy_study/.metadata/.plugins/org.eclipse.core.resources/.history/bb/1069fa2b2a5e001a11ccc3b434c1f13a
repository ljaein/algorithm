package study0301;

import java.util.Scanner;

public class Solution_D4_1808_지희의고장난계산기 {

	static int X;
	static int[] num;
	static int[] dp;

	public static void main(String[] args) {
		Scanner sc = new Scanner(System.in);
		int T = sc.nextInt();
		for (int t = 1; t <= T; t++) {
			num = new int[10];
			for (int i = 0; i < 10; i++)
				num[i] = sc.nextInt();
			X = sc.nextInt();
			dp = new int[X + 1];
			for (int i = 0; i < 10; i++){
				if(num[i]==1)
					dp[i]=1;
			}
			System.out.println(calc(X));
		}

	}

	static int calc(int n) {
		if (dp[n] != 0) {
			return dp[n];
		}
		dp[n] = numcnt(n);
		System.out.println(n+ " : "+dp[n]);
		for (int i = 1; i <= (int) Math.sqrt(n); i++) {
			if (n % i == 0) {
				System.out.println("짝 : "+i+" "+(n/i));
				int n1 = calc(i);
				int n2 = calc(n / i);
				System.out.println("결과 : "+n1+" "+n2);
				if (n1 != Integer.MAX_VALUE && n2 != Integer.MAX_VALUE){
					dp[n] = Math.min(dp[n], n1 + n2 + 1);
					System.out.println("in "+n+" -> "+dp[n]);
				}
			}
		}
		return dp[n];
	}

	static int numcnt(int n) {
		int cnt = 0;
		while (n >0) {
			int rest = n % 10;
			if (num[rest] == 0)
				return Integer.MAX_VALUE;
			n = n / 10;
			cnt++;
		}
		return cnt;
	}

}
